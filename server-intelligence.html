<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>LW Servers</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="robots" content="index, follow">
  <meta name="description" content="Server intelligence, alliance dominance, elite power rankings and strategic comparisons.">
  <link rel="stylesheet" href="/css/server-intelligence.css" />
  <link rel="manifest" href="/manifest.json">
  <!-- Standard favicon -->
<link rel="icon" href="/favicon.ico" sizes="any">

<!-- PNG favicons -->
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16.png">

<meta name="theme-color" content="#00ffc8">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="KOBRA">

<link rel="apple-touch-icon" href="/assets/icons/icon-192.png">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1248850512161754"
     crossorigin="anonymous"></script>
     <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6SBZ7TWCCE"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-6SBZ7TWCCE');
 gtag('event', 'alliance_selected', {
});


</script>

<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

</head>
<input
  type="file"
  id="excelAllianceInput"
  accept=".xlsx,.xls"
  style="display:none"
/>

<body class="bg">

<!-- ğŸŒ GLOBAL INTELLIGENCE LOADER -->
<div id="appLoader" class="intel-loader">
  <div class="map-layer">
    <img src="/assets/world-map.svg" class="world-map" />
    <svg class="flow-lines" viewBox="0 0 280 160">
  <line x1="30" y1="40" x2="140" y2="80" />
  <line x1="70" y1="90" x2="140" y2="80" />
  <line x1="220" y1="50" x2="140" y2="80" />
  <line x1="240" y1="120" x2="140" y2="80" />
</svg>

    <div class="intel-core"></div>

    <!-- Pulses from different regions -->
    <span class="pulse p1"></span>
    <span class="pulse p2"></span>
    <span class="pulse p3"></span>
    <span class="pulse p4"></span>
    <span class="pulse p5"></span>
  </div>

 <div class="intel-text">
  <span id="intelFeed">Initializing global intelligenceâ€¦</span>
</div>

  <div class="progress-ring">
  <svg width="60" height="60">
    <circle cx="30" cy="30" r="26" />
    <circle cx="30" cy="30" r="26" class="progress" />
  </svg>
  <div id="progressText" class="progress-text">0%</div>
</div>

</div>

<!-- MAIN APP CONTENT -->
<div class="page">

<div class="page">

  <!-- HEADER -->
  <header class="header">
    <h1>LAST WAR SERVER INTELLIGENCE</h1>
    <div class="sub">Alliance & Warzone Power Analytics</div>
<!-- ADMIN BAR (ADMIN ONLY) -->
<div class="admin-bar admin-only" id="adminBar">
  <span class="admin-badge">ğŸ›¡ï¸ ADMIN MODE</span>
  <button id="logoutBtn" class="admin-logout-btn">Logout</button>
</div>

  </header>

<!-- TOP META INFO -->
<div class="top-meta">
  <div class="last-updated">
    ğŸ•’ Last Updated: <span id="lastUpdated">â€”</span>
  </div>

 <a
  href="https://discord.gg/QfSsUCgFJW"
  target="_blank"
  class="discord-cta"
  title="Request to add your server on Discord"
>
  <span class="discord-icon">
    <svg viewBox="0 0 245 240" aria-hidden="true">
      <path d="M104.4 104.1c-5.7 0-10.2 5-10.2 11.1 0 6.1 4.6 11.1 10.2 11.1 5.7 0 10.2-5 10.2-11.1 0-6.1-4.6-11.1-10.2-11.1zm36.1 0c-5.7 0-10.2 5-10.2 11.1 0 6.1 4.6 11.1 10.2 11.1 5.7 0 10.2-5 10.2-11.1 0-6.1-4.6-11.1-10.2-11.1z"/>
      <path d="M189.5 20h-134C24.5 20 20 24.6 20 30.3v179.4c0 5.7 4.5 10.3 10.3 10.3h113.1l-5.3-18.5 12.8 11.9 12.1 11.2 21.5 19V30.3c0-5.7-4.5-10.3-10.3-10.3z"/>
    </svg>
  </span>
  <span class="discord-text">
    Request Server
  </span>
</a>



</div>


  <!-- STATS OVERVIEW -->
  <section class="stats-overview">
    <div class="stat-card">
      <div class="stat-label">TOTAL PLAYERS</div>
      <div class="stat-value" id="totalPlayers">0</div>
    </div>

    <div class="stat-card">
      <div class="stat-label">WARZONES</div>
      <div class="stat-value" id="totalWarzones">0</div>
    </div>

    <div class="stat-card">
      <div class="stat-label">ALLIANCES</div>
      <div class="stat-value" id="totalAlliances">0</div>
    </div>
  </section>

  <!-- ğŸ† TOP 5 ELITE PLAYERS -->
  <section class="top5-glory">
    <h2 class="section-title">Top 5 Power Holders</h2>
    <div id="top5Grid" class="top5-grid"></div>
  </section>
<!-- QUICK ACTION CARDS -->
<div class="kobra-card-row">

  <!-- GLOBAL TOP TOGGLE -->
  <div
    id="globalTopToggle"
    class="kobra-card-btn"
    style="cursor:pointer;"
    title="Toggle global ranking size"
  >
    <div class="kobra-card-icon">ğŸ†</div>
    <div class="kobra-card-text">
      <div class="kobra-card-title" id="globalTopTitle">TOP 20</div>
      <div class="kobra-card-sub" id="globalTopSub">
        Global power ranking
      </div>
    </div>
  </div>
<a href="/buster" class="kobra-card-btn">

    <div class="kobra-card-icon">ğŸ“Š</div>
    <div class="kobra-card-text">
      <div class="kobra-card-title">Buster</div>
      <div class="kobra-card-sub">Test before Strenght</div>
    </div>
  </a>

  <a href="/alliance-showdown" class="kobra-card-btn">
    <div class="kobra-card-icon">ğŸ›¡ï¸</div>
    <div class="kobra-card-text">
      <div class="kobra-card-title">SHOWDOWN</div>
      <div class="kobra-card-sub">Strategic Simulation</div>
    </div>
  </a>

</div>


  <!-- SEARCH -->
  <section class="search-bar">
    <input id="searchInput" placeholder="ğŸ” Search player name" />
  </section>

<!-- =============================
     DISCOVERY SECTION
============================= -->
<section class="discovery-grid">

  <!-- DIVE INTO SERVER DATA CARD -->
  <div
    class="discovery-card dive-trigger"
    id="openWarzoneModal"
  >
    <div class="dive-title">
      ğŸŒ Dive into Server Data
    </div>

    <div class="dive-sub">
      Currently viewing:
      <strong id="activeWarzoneLabel">
        All Warzones
      </strong>
    </div>

    <div class="dive-hint">
      Explore servers, alliances & power trends
    </div>
  </div>
<!-- Alliance Lookup Card -->
<div class="alliance-lookup-card">

  <div class="al-header">
    <div class="al-title">ğŸ” Find Alliance</div>
  </div>

  <input
    id="allianceLookupInput"
    type="text"
    placeholder=""
    autocomplete="off"
  />

  <div class="al-helper">
    Example: <strong>koj</strong>, <strong>UDIE</strong>
  </div>

  <!-- ğŸ”´ THIS WAS MISSING -->
  <div id="allianceLookupResult" class="al-result muted">
    <div class="al-muted">
      
    </div>
  </div>

  <div class="al-credit">
  Data provided by
  <span class="al-credit-brand">Coordinates List</span>
  <span class="al-credit-muted">Discord</span>
</div>

</div>



<!-- Discord Coordination Modal -->
<div id="allianceDiscordModal" class="discord-modal-overlay hidden">

  <div class="discord-modal">

    <!-- Banner -->
    <img
      src="/assets/discord-modal-banner.png"
      alt="Official Coordinates Discord"
      class="discord-modal-banner"
    />

    <div class="discord-modal-body">

      <h3>Alliance Located</h3>

      <div class="modal-info">
        <div><strong>Alliance:</strong> <span id="modalAllianceName">â€”</span></div>
        <div><strong>Warzone:</strong> <span id="modalWarzone">â€”</span></div>
        <div class="modal-updated">
          Updated: <span id="modalUpdated">â€”</span>
        </div>
      </div>

      <div class="modal-credit">
        Coordinates provided by the official community<br>
        <strong>Last War Coordinates Discord</strong><br>
        (Princess Wolfy & team)
      </div>

      <a
        id="discordLink"
        class="discord-btn"
        href="https://discord.gg/gSGDxeuKX3"
        target="_blank"
        rel="noopener"
      >
        <img
          src="https://cdn-icons-png.flaticon.com/512/2111/2111370.png"
          alt="Discord"
        />
        Open Discord
      </a>

      <div class="modal-note">
        Please respect server rules and use the correct channel.
      </div>

      <button class="discord-modal-close">Close</button>

    </div>
  </div>
</div>







</section>

<!-- =============================
     WARZONE MODAL
============================= -->
<div class="modal-overlay hidden" id="warzoneModal">
  <div class="modal">
    <div class="modal-header">
      Select Warzone
    </div>

    <input
      type="text"
      id="warzoneSearchInput"
      placeholder="Search warzoneâ€¦"
      autocomplete="off"
    />

    <div id="warzoneList" class="modal-list"></div>

    <button class="modal-close" id="closeWarzoneModal">
      Close
    </button>
  </div>
</div>

  <!-- FILTERS -->
  <section class="filters">
    <div class="filter-group">
      
      
      <div id="warzoneCards" class="filter-cards"></div>
    </div>

    <div class="filter-group">
      
      <div id="allianceCards" class="filter-cards"></div>
    </div>
  </section>

<!-- ğŸ¥‡ TOP PLAYER HIGHLIGHT (CONTEXTUAL) -->
<section class="top-rank-segment hidden" id="topRankSegment">
  <div class="top-rank-card">

    <div class="top-rank-left">
      <div class="top-rank-crown">ğŸ‘‘</div>

      <div class="top-rank-text">
        <div class="top-rank-label" id="topRankLabel"></div>
        <div class="top-rank-name" id="topRankName"></div>
      </div>
    </div>

    <!-- Right side -->
    <div class="top-rank-right">
      <div class="top-rank-power" id="topRankPower"></div>
      <div class="top-rank-s1" id="topRankS1"></div>
    </div>

  </div>
</section>


  <!-- POWER SEGMENTS -->
  <section class="segments">
    <div class="segment mega">
      ğŸ‹ Mega Whales
      <span id="megaWhaleCount">0</span>
      <small>230M+ Power</small>
    </div>

    <div class="segment whale">
      ğŸ‹ Whales
      <span id="whaleCount">0</span>
      <small>180Mâ€“229M</small>
    </div>

    <div class="segment shark">
      ğŸ¦ˆ Sharks
      <span id="sharkCount">0</span>
      <small>160Mâ€“179M</small>
    </div>

    <div class="segment piranha">
      ğŸŸ Piranhas
      <span id="piranhaCount">0</span>
      <small>140Mâ€“159M</small>
    </div>

    <div class="segment shrimp">
      ğŸ¦ Shrimps
      <span id="shrimpCount">0</span>
      <small>Below 140M</small>
    </div>
<div class="segment base-power hidden base-power-neutral" id="basePowerSegment">
  ğŸ“‰ Base Power
  <span id="basePowerValue">â€”</span>
  <small id="basePowerLabel"></small>

  <!-- Tooltip -->
  <span class="info-tooltip">
    â“˜
    <span class="tooltip-content">
      <strong>Base Power Benchmark</strong><br/>
      Shows the effective power of the <b>200th ranked player</b> in the selected warzone.<br/><br/>
      When an alliance is selected, the percentage compares the
      <b>weakest alliance member</b> against this warzone baseline.
    </span>
  </span>
</div>


  </section>

  <!-- ALLIANCE DOMINANCE -->
 <section class="dominance" id="dominanceSection">
  <h2>Alliance Dominance (%)</h2>
  <div id="dominanceGrid" class="dominance-grid"></div>
</section>


  <!-- ALLIANCE COMPARISON 
  <section class="comparison">
    <h2>Alliance vs Alliance</h2>
    <div class="compare-controls">
      <select id="compareAllianceA"></select>
      <select id="compareAllianceB"></select>
      <button id="compareBtn">Compare</button>
    </div>
    <div id="comparisonResult" class="comparison-result"></div>
  </section>-->



   <!-- MOBILE PLAYER LIST --> <!-- DATA TABLE -->
<div id="mobileList" class="mobile-only mobile-list"></div>

  <!-- ELITE LEADERBOARD -->
<section class="leaderboard">
  <div id="playerList" class="player-list"></div>
 
</section>
 <div id="scrollSentinel"></div>


<!--<div class="power-legend">
  <span>âœ… Confirmed â€” Admin verified</span>
  <span>âš™ï¸ Estimated â€” Auto growth</span>
</div> -->



  <!-- ADMIN PANEL (HIDDEN FOR PUBLIC) -->
  <details class="admin-panel admin-only" id="adminPanel">

    <summary>âš™ Admin Data Import</summary>

    <div class="admin-hint">
      Format per line:<br>
      <code>Rank | Alliance | Name | Warzone | TotalPower</code>
    </div>

    <textarea id="pasteData" placeholder="Paste data hereâ€¦"></textarea>
    <input type="file" id="excelInput" />
    <button id="saveBtn">Upload</button>

    <button onclick="deleteByUploadId('upload-1702872239123')">
  ğŸ—‘ï¸ Delete
</button>
<a
  id="adminConflictsLink"
  href="/admin-conflicts.html"
  class="admin-link hidden"
>
  âš ï¸ Excel Conflicts
</a>
<div class="admin-toggle">
  <label>
    <input type="checkbox" id="likesToggle">
    Enable Likes
  </label>
</div>


  </details>

</div>


<footer class="site-footer">
  <div class="footer-inner">
    <span>Â© 2025 LWServers</span>
    <small style="opacity:.75;">
      Independent fan-made analytics. Not affiliated with or endorsed by the game developers.
    </small>
    <nav>
      <a href="/privacy.html">Privacy</a>
      <a href="/terms.html">Terms</a>
      <a href="/contact.html">Contact</a>
    </nav>
  </div>
</footer>


<!-- SCRIPTS -->
 <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
<script type="module" src="/js/server-intelligence.js"></script>
<script src="/js/alliance-lookup.js"></script>

<!-- ADMIN VISIBILITY CONTROL -->


<script type="module">
  import { onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
  import { auth } from "/js/firebase-config.js";

  onAuthStateChanged(auth, async (user) => {
    const adminEls = document.querySelectorAll(".admin-only");

    if (!user) return;

    try {
      const token = await user.getIdTokenResult(true); // force refresh
      if (token.claims.admin === true) {
        adminEls.forEach(el => {
  el.style.setProperty("display", "block", "important");

});
      }
    } catch (e) {
      console.warn("Admin check failed", e);
    }
  });
</script>




<!-- EDIT POWER MODAL -->
<div id="editPowerModal" class="modal hidden">
  <div class="modal-card">

    <div class="modal-header">
      <h3>Edit Player Power</h3>
      <button class="modal-close" onclick="closeEditPowerModal()">âœ•</button>
    </div>

    <div class="modal-body">
      <div class="modal-row">
        <span class="label">Player</span>
        <span id="epPlayerName">â€”</span>
      </div>

      <div class="modal-row">
        <span class="label">Warzone</span>
        <span id="epWarzone">â€”</span>
      </div>

      <div class="modal-row">
        <span class="label">Current Power</span>
        <span id="epCurrentPower">â€”</span>
      </div>
<!-- ğŸ”¥ NEW: Editable Name -->
<div class="modal-row">
  <label class="label">Player Name</label>
  <input
    id="epNewName"
    type="text"
    placeholder="Edit name (any language / emoji allowed)"
  />
</div>

<!-- ğŸ”¥ NEW: Editable Warzone -->
<div class="modal-row">
  <label class="label">Warzone</label>
  <input
    id="epNewWarzone"
    type="number"
    min="1"
    placeholder="Transfer to warzone"
  />
</div>
      <div class="modal-row">
        <label class="label">New Power</label>
        <input
          id="epNewPower"
          type="number"
          placeholder="Enter new power"
        />
      </div>

      <div class="modal-hint" id="epHint">
        Enter new power to continue
      </div>
    </div>

    <div class="modal-footer">
      <button class="btn-secondary" onclick="closeEditPowerModal()">Cancel</button>
      <button class="btn-primary" id="epSaveBtn" disabled>
       Save (disabled)
      </button>
    </div>

  </div>
</div>

...
</main>

<!-- Buy Me a Coffee -->
<script
  data-name="BMC-Widget"
  data-cfasync="false"
  src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js"
  data-id="aktiarlwsk"
  data-description="Support independent analytics & data work"
  data-message="Thanks for supporting the project â˜•"
  data-color="#40DCA5"
  data-position="Right"
  data-x_margin="18"
  data-y_margin="18">
</script>

</body>
</html>



</body>
</html>

